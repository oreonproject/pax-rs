.\" -*- mode: troff; coding: utf-8 -*-
.\" Automatically generated by Pod::Man 5.01 (Pod::Simple 3.45)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" \*(C` and \*(C' are quotes in nroff, nothing in troff, for use with C<>.
.ie n \{\
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\" ========================================================================
.\"
.IX Title "LOGPROF.CONF 5"
.TH LOGPROF.CONF 5 2024-02-02 "AppArmor 3.1.7" AppArmor
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH NAME
logprof.conf \- configuration file for expert options that modify the
behavior of the AppArmor aa\-logprof(1) program.
.SH DESCRIPTION
.IX Header "DESCRIPTION"
The \fBaa\-logprof\fR\|(1) program can be configured to have certain default behavior
by the contents of logprof.conf.
.PP
The \fB[qualifiers]\fR section lists specific programs that should have
a subset of the full ix/px/ux list when asking what mode to execute
it using.
.PP
Since creating a separate profile for /bin/bash is dangerous, we can
specify that for /bin/bash, only (I)nherit, (U)nconstrained, and (D)eny
should be allowed options and only those will show up in the prompt when
we're asking about adding that to a profile.
.PP
Likewise, if someone currently exec's /bin/mount in ix or px mode, things
won't work, so we can provide only (U)nconstrained and (D)eny as options.
.PP
And certain apps like grep, awk, sed, cp, and mkdir should always
inherit the parent profile rather than having their own profile or
running unconfined, so for them we can specify that only (I)nherit and
(D)eny are the allowed options.
.PP
Any programs that are not listed in the qualifiers section get the full
(I)nherit / (P)rofile / (U)nconstrained / (D)eny option set.
.PP
If the user is doing something tricky and wants different behavior,
they can tweak or remove the corresponding line in the conf file.
.PP
The \fB[defaulthat]\fR section lists changehat-aware programs and what hat
\&\fBaa\-logprof\fR\|(1) will collapse the entries to for that program if the user
specifies that the access should be allowed, but should not have it's
own hat.
.PP
The \fB[globs]\fR section allows modification of the logprof rule engine
with respect to globbing suggestions that the user will be prompted with.
.PP
The format of each line is\-\- "<perl glob> = <apparmor glob>".
.PP
When \fBaa\-logprof\fR\|(1) asks about a specific path, if the perl glob matches the
path, it replaces the part of the path that matched with the corresponding
apparmor glob and adds it to the list of globbing suggestions.
.PP
Lines starting with # are comments and are ignored.
.SH EXAMPLE
.IX Header "EXAMPLE"
.Vb 3
\&  [qualifiers]
\&    # things will very likely be painfully broken if bash has it\*(Aqs own profile
\&    /bin/bash  = iu
\&
\&    # mount doesn\*(Aqt work if it\*(Aqs confined
\&    /bin/mount = u
\&
\&    # these helper utilities should inherit the parent profile and
\&    # shouldn\*(Aqt have their own profiles
\&    /bin/awk   = i
\&    /bin/grep  = i
\&    /bin/sed   = i
\&
\&  [defaulthat]
\&    /usr/sbin/sshd           = EXEC
\&    /usr/sbin/httpd2         = DEFAULT_URI
\&    /usr/sbin/httpd2\-prefork = DEFAULT_URI
\&
\&  [globs]
\&    # /foo/bar/lib/libbaz.so \-> /foo/bar/lib/lib*
\&    /lib/lib[^\e/]+so[^\e/]*$  = /lib/lib*so*
\&
\&    # strip kernel version numbers from kernel module accesses
\&    ^/lib/modules/[^\e/]+\e/   = /lib/modules/*/
\&
\&    # strip pid numbers from /proc accesses
\&    ^/proc/\ed+/              = /proc/*/
.Ve
.SH BUGS
.IX Header "BUGS"
If you find any bugs, please report them at
<https://gitlab.com/apparmor/apparmor/\-/issues>.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fBapparmor\fR\|(7), \fBapparmor.d\fR\|(5), \fBaa\-enforce\fR\|(1), \fBaa\-complain\fR\|(1),
\&\fBaa\-disable\fR\|(1), \fBaa_change_hat\fR\|(2), \fBaa\-logprof\fR\|(1), \fBaa\-genprof\fR\|(1), and
<https://wiki.apparmor.net>.
